import{sendData}from"./api.js";import{createSuccessMessage,createErrorMessage}from"./modal-message.js";const USERNAME_MAX_LENGTH=10,USERNAME_ERROR_TEXT="Нельзя указать больше 10 символов.",PHONE_VALID_SYMBOLS=/^[\d\+][\d\(\)\ -]{4,14}\d$/,PHONE_ERROR_TEXT='Номер должен быть валидным. Первый символ должен быть цифрой или "+".',EMAIL_VALID_SYMBOLS=/^[\w-\.]+@[\w-]+\.[a-z]{2,4}$/i,EMAIL_ERROR_TEXT='EMAIL должен быть валидным. В адресе отсутствует символ "@".',SubmitButtonText={IDLE:"ОТПРАВИТЬ ОТЗЫВ",SENDING:"ПУБЛИКУЮ ОТЗЫВ"},form=document.querySelector(".form__application"),userNameField=document.querySelector(".username__field--name"),userSurnameField=document.querySelector(".username__field--surname"),phoneField=document.querySelector(".contacts__field--phone"),emailField=document.querySelector(".contacts__field--email"),submitButton=document.querySelector(".form__button"),pristine=new Pristine(form,{classTo:"pristine-form",errorTextParent:"pristine-form",errorTextClass:"pristine-form--error"}),resetForm=()=>{form.reset(),pristine.reset()},isValidPhone=e=>PHONE_VALID_SYMBOLS.test(e),validatePhone=e=>isValidPhone(e);pristine.addValidator(phoneField,validatePhone,PHONE_ERROR_TEXT);const isValidEmail=e=>EMAIL_VALID_SYMBOLS.test(e),validateEmail=e=>isValidEmail(e);pristine.addValidator(emailField,validateEmail,EMAIL_ERROR_TEXT);const isValidUsername=e=>e.length<10,validateUsername=e=>isValidUsername(e);pristine.addValidator(userNameField,validateUsername,USERNAME_ERROR_TEXT),pristine.addValidator(userSurnameField,validateUsername,USERNAME_ERROR_TEXT);const blockSubmitButton=()=>{submitButton.disabled=!0,submitButton.textContent=SubmitButtonText.SENDING},unblockSubmitButton=()=>{submitButton.disabled=!1,submitButton.textContent=SubmitButtonText.IDLE},setOnFormSubmit=e=>{form.addEventListener("submit",(t=>{t.preventDefault();pristine.validate()&&(submitButton.disabled=!0,submitButton.textContent=SubmitButtonText.SENDING,sendData(new FormData(t.target)).then(e).then(createSuccessMessage).catch(createErrorMessage).finally(unblockSubmitButton))}))};export{setOnFormSubmit,resetForm};